USE SCHEMA RAW;
-- define patient table

CREATE OR REPLACE TABLE RAW.PATIENTS (
    Id STRING, 
    BIRTHDATE DATE,
    DEATHDATE DATE,
    SSN STRING,
    DRIVERS STRING,
    PASSPORT STRING,
    PREFIX STRING,
    FIRST STRING,
    LAST STRING,
    SUFFIX STRING,
    MAIDEN STRING,
    MARITAL STRING,
    RACE STRING,
    ETHNICITY STRING,
    GENDER STRING,
    BIRTHPLACE STRING,
    ADDRESS STRING,
    CITY STRING,
    STATE STRING,
    COUNTY STRING,
    ZIP STRING,
    LAT STRING,
    LON STRING,
    HEALTHCARE_EXPENSES STRING,
    HEALTHCARE_COVERAGE STRING
);


CREATE OR REPLACE TABLE RAW.CONDITIONS(
    START_DATE DATE,
    STOP_DATE DATE,
    PATIENT STRING,
    ENCOUNTER STRING,
    CODE STRING,
    DESCRIPTION STRING
);

CREATE OR REPLACE TABLE RAW.MEDICATIONS(
    START_DATE DATE,
    STOP_DATE DATE,
    PATIENT STRING,
    PAYERSTRING STRING,
    ENCOUNTER STRING,
    CODE STRING,
    DESCRIPTION STRING,
    BASE_COST STRING,
    PAYER_COVERAGE STRING,
    DISPENSES STRING,
    TOTALCOST STRING,
    REASONCODE STRING,
    REASONDESCRIPTION STRING
);

CREATE OR REPLACE TABLE RAW.OBSERVATIONS(
    DATE DATE,
    PATIENT STRING, 
    ENCOUNTER STRING,
    CODE STRING,
    DESCRIPTION STRING,
    VALUE STRING,
    UNITS STRING,
    TYPE STRING
);

CREATE OR REPLACE TABLE RAW.ENCOUNTERS (
    Id STRING,
    START_DATE DATE,
    STOP_DATE DATE,
    PATIENT STRING, 
    ORGANIZATION STRING, 
    PROVIDER STRING, 
    PAYER STRING, 
    ENCOUNTERCLASS STRING, 
    CODE STRING, 
    DESCRIPTION STRING, 
    BASE_ENCOUNTER_COST STRING, 
    TOTAL_CLAIM_COST STRING, 
    PAYER_COVERAGE STRING, 
    REASONCODE STRING, 
    REASONDESCRIPTION STRING
);

CREATE OR REPLACE TABLE RAW.ORGANIZATIONS (
    Id STRING, 
    NAME STRING,
    ADDRESS STRING,
    CITY STRING,
    STATE STRING,
    ZIP STRING,
    LAT STRING,
    LON STRING,
    PHONE STRING,
    REVENUE STRING,
    UTILIZATION STRING
);


CREATE OR REPLACE TABLE RAW.PROCEDURES (
    DATE DATE,
    PATIENT STRING,
    ENCOUNTER STRING,
    CODE STRING,
    DESCRIPTION STRING,
    BASE_COST STRING,
    REASONCODE STRING,
    REASONDESCRIPTION STRING
);


-- Stage files
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/patients.csv @%PATIENTS;
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/conditions.csv @%CONDITIONS;
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/medications.csv @%MEDICATIONS;
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/observations.csv @%OBSERVATIONS;
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/encounters.csv @%ENCOUNTERS;
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/organizations.csv @%ORGANIZATIONS;
PUT file:///Users/mariolawes/Documents/Ressourcen/syntheaProject/source_data/procedures.csv @%PROCEDURES;

-- fill tables
COPY INTO RAW.PATIENTS
FROM @%PATIENTS
FILE_FORMAT = (TYPE=CSV SKIP_HEADER=1);

COPY INTO RAW.CONDITIONS
FROM @%CONDITIONS
FILE_FORMAT = (TYPE=CSV SKIP_HEADER=1);

COPY INTO RAW.MEDICATIONS
FROM @%MEDICATIONS
FILE_FORMAT = (TYPE=CSV SKIP_HEADER=1);

COPY INTO RAW.OBSERVATIONS
FROM @%OBSERVATIONS
FILE_FORMAT = (TYPE=CSV SKIP_HEADER=1);

COPY INTO RAW.ORGANIZATIONS
FROM @%ORGANIZATIONS
FILE_FORMAT = (TYPE=CSV SKIP_HEADER=1);

COPY INTO RAW.PROCEDURES
FROM @%PROCEDURES
FILE_FORMAT = (TYPE=CSV SKIP_HEADER=1);